!function(t,n,e,a){"use strict";Foundation.libs.clearing={name:"clearing",version:"4.3.3",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><img src="//:0"><p class="clearing-caption"></p><a href="#" class="clearing-main-prev"><span></span></a><a href="#" class="clearing-main-next"><span></span></a></div>'},close_selectors:".clearing-close",init:!1,locked:!1},init:function(n,e,a){var i=this;return Foundation.inherit(this,"set_data get_data remove_data throttle data_options"),"object"==typeof e&&(a=t.extend(!0,this.settings,e)),"string"!=typeof e?(t(this.scope).find("ul[data-clearing]").each(function(){var n=t(this),e=e||{},a=n.find("li"),o=i.get_data(n);!o&&a.length>0&&(e.$parent=n.parent(),i.set_data(n,t.extend({},i.settings,e,i.data_options(n))),i.assemble(n.find("li")),i.settings.init||i.events().swipe_events())}),this.settings.init):this[e].call(this,a)},events:function(){var e=this;return t(this.scope).on("click.fndtn.clearing","ul[data-clearing] li",function(n,a,i){var a=a||t(this),i=i||a,o=a.next("li"),s=e.get_data(a.parent()),l=t(n.target);n.preventDefault(),s||e.init(),i.hasClass("visible")&&a[0]===i[0]&&o.length>0&&e.is_open(a)&&(i=o,l=i.find("img")),e.open(l,a,i),e.update_paddles(i)}).on("click.fndtn.clearing",".clearing-main-next",function(t){this.nav(t,"next")}.bind(this)).on("click.fndtn.clearing",".clearing-main-prev",function(t){this.nav(t,"prev")}.bind(this)).on("click.fndtn.clearing",this.settings.close_selectors,function(t){Foundation.libs.clearing.close(t,this)}).on("keydown.fndtn.clearing",function(t){this.keydown(t)}.bind(this)),t(n).on("resize.fndtn.clearing",function(){this.resize()}.bind(this)),this.settings.init=!0,this},swipe_events:function(){var n=this;t(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(n){n.touches||(n=n.originalEvent);var e={start_page_x:n.touches[0].pageX,start_page_y:n.touches[0].pageY,start_time:(new Date).getTime(),delta_x:0,is_scrolling:a};t(this).data("swipe-transition",e),n.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(e){if(e.touches||(e=e.originalEvent),!(e.touches.length>1||e.scale&&1!==e.scale)){var a=t(this).data("swipe-transition");if("undefined"==typeof a&&(a={}),a.delta_x=e.touches[0].pageX-a.start_page_x,"undefined"==typeof a.is_scrolling&&(a.is_scrolling=!!(a.is_scrolling||Math.abs(a.delta_x)<Math.abs(e.touches[0].pageY-a.start_page_y))),!a.is_scrolling&&!a.active){e.preventDefault();var i=a.delta_x<0?"next":"prev";a.active=!0,n.nav(e,i)}}}).on("touchend.fndtn.clearing",".visible-img",function(n){t(this).data("swipe-transition",{}),n.stopPropagation()})},assemble:function(n){var e=n.parent();e.after('<div id="foundationClearingHolder"></div>');var a=t("#foundationClearingHolder"),i=this.get_data(e),o=e.detach(),s={grid:'<div class="carousel">'+this.outerHTML(o[0])+"</div>",viewing:i.templates.viewing},l='<div class="clearing-assembled"><div>'+s.viewing+s.grid+"</div></div>";return a.after(l).remove()},open:function(t,n,e){var a=e.closest(".clearing-assembled"),i=a.find("div").first(),o=i.find(".visible-img"),s=o.find("img").not(t);this.locked()||(o.trigger("open.fndtn.clearing",t.attr("id")),s.attr("src",this.load(t)).css("visibility","hidden"),this.loaded(s,function(){s.css("visibility","visible"),a.addClass("clearing-blackout"),i.addClass("clearing-container"),o.show(),this.fix_height(e).caption(o.find(".clearing-caption"),t).center(s).shift(n,e,function(){e.siblings().removeClass("visible"),e.addClass("visible")}),o.trigger("opened.fndtn.clearing")}.bind(this)))},close:function(n,e){n.preventDefault();var a,i,o=function(t){return/blackout/.test(t.selector)?t:t.closest(".clearing-blackout")}(t(e));return e===n.target&&o&&(a=o.find("div").first(),i=a.find(".visible-img"),i.trigger("close.fndtn.clearing"),this.settings.prev_index=0,o.find("ul[data-clearing]").attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout"),a.removeClass("clearing-container"),i.hide(),i.trigger("closed.fndtn.clearing")),!1},is_open:function(t){return t.parent().prop("style").length>0},keydown:function(n){var e=t(".clearing-blackout").find("ul[data-clearing]");39===n.which&&this.go(e,"next"),37===n.which&&this.go(e,"prev"),27===n.which&&t("a.clearing-close").trigger("click")},nav:function(n,e){var a=t(".clearing-blackout").find("ul[data-clearing]");n.preventDefault(),this.go(a,e)},resize:function(){var n=t(".clearing-blackout .visible-img").find("img");n.length&&(this.center(n),n.trigger("resized.fndtn.clearing"))},fix_height:function(n){var e=n.parent().children(),a=this;return e.each(function(){var n=t(this),e=n.find("img");n.height()>a.outerHeight(e)&&n.addClass("fix-height")}).closest("ul").width(100*e.length+"%"),this},update_paddles:function(t){var n=t.closest(".carousel").siblings(".visible-img");t.next().length>0?n.find(".clearing-main-next").removeClass("disabled"):n.find(".clearing-main-next").addClass("disabled"),t.prev().length>0?n.find(".clearing-main-prev").removeClass("disabled"):n.find(".clearing-main-prev").addClass("disabled")},center:function(t){return this.rtl?t.css({marginRight:-(this.outerWidth(t)/2),marginTop:-(this.outerHeight(t)/2)}):t.css({marginLeft:-(this.outerWidth(t)/2),marginTop:-(this.outerHeight(t)/2)}),this},load:function(t){if("A"===t[0].nodeName)var n=t.attr("href");else var n=t.parent().attr("href");return this.preload(t),n?n:t.attr("src")},preload:function(t){this.img(t.closest("li").next()).img(t.closest("li").prev())},loaded:function(t,n){function e(){n()}function a(){if(this.one("load",e),/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var t=this.attr("src"),n=t.match(/\?/)?"&":"?";n+="random="+(new Date).getTime(),this.attr("src",t+n)}}return t.attr("src")?(t[0].complete||4===t[0].readyState?e():a.call(t),void 0):(e(),void 0)},img:function(t){if(t.length){var n=new Image,e=t.find("a");n.src=e.length?e.attr("href"):t.find("img").attr("src")}return this},caption:function(t,n){var e=n.data("caption");return e?t.html(e).show():t.text("").hide(),this},go:function(t,n){var e=t.find(".visible"),a=e[n]();a.length&&a.find("img").trigger("click",[e,a]).trigger("change.fndtn.clearing")},shift:function(t,n,e){var a,i=n.parent(),o=this.settings.prev_index||n.index(),s=this.direction(i,t,n),l=parseInt(i.css("left"),10),r=this.outerWidth(n);n.index()===o||/skip/.test(s)?/skip/.test(s)&&(a=n.index()-this.settings.up_count,this.lock(),a>0?i.animate({left:-(a*r)},300,this.unlock()):i.animate({left:0},300,this.unlock())):/left/.test(s)?(this.lock(),i.animate({left:l+r},300,this.unlock())):/right/.test(s)&&(this.lock(),i.animate({left:l-r},300,this.unlock())),e()},direction:function(n,e,a){var i,o=n.find("li"),s=this.outerWidth(o)+this.outerWidth(o)/4,l=Math.floor(this.outerWidth(t(".clearing-container"))/s)-1,r=o.index(a);return this.settings.up_count=l,i=this.adjacent(this.settings.prev_index,r)?r>l&&r>this.settings.prev_index?"right":r>l-1&&r<=this.settings.prev_index?"left":!1:"skip",this.settings.prev_index=r,i},adjacent:function(t,n){for(var e=n+1;e>=n-1;e--)if(e===t)return!0;return!1},lock:function(){this.settings.locked=!0},unlock:function(){this.settings.locked=!1},locked:function(){return this.settings.locked},outerHTML:function(t){return t.outerHTML||(new XMLSerializer).serializeToString(t)},off:function(){t(this.scope).off(".fndtn.clearing"),t(n).off(".fndtn.clearing"),this.remove_data(),this.settings.init=!1},reflow:function(){this.init()}}}(Foundation.zj,this,this.document);